async function j(){const c=document.querySelector('[data-calc="clt-pj"]');if(!c)return;const y=typeof FGTS_RATE=="number"?FGTS_RATE:.08,M=typeof INSS_PJ_RATE=="number"?INSS_PJ_RATE:.11,$=typeof SUG_PROLABORE_FATOR_R=="number"?SUG_PROLABORE_FATOR_R:.28,u={inss:[{ceiling:1320,rate:.075},{ceiling:2571.29,rate:.09},{ceiling:3856.94,rate:.12},{ceiling:7507.49,rate:.14}],irrf:{dependente:189.59,tabela:[{min:0,rate:0,deduction:0},{min:2259.21,rate:.075,deduction:169.44},{min:2826.66,rate:.15,deduction:381.44},{min:3751.06,rate:.225,deduction:662.77},{min:4664.69,rate:.275,deduction:896}]}},C={III:[{faixa:1,max:18e4,aliq:.06,pd:0},{faixa:2,max:36e4,aliq:.112,pd:9360},{faixa:3,max:72e4,aliq:.135,pd:17640},{faixa:4,max:18e5,aliq:.16,pd:35640},{faixa:5,max:36e5,aliq:.21,pd:125640},{faixa:6,max:48e5,aliq:.33,pd:648e3}],V:[{faixa:1,max:18e4,aliq:.155,pd:0},{faixa:2,max:36e4,aliq:.18,pd:4500},{faixa:3,max:72e4,aliq:.195,pd:9900},{faixa:4,max:18e5,aliq:.205,pd:17100},{faixa:5,max:36e5,aliq:.23,pd:62100},{faixa:6,max:48e5,aliq:.305,pd:54e4}],IV:[{faixa:1,max:18e4,aliq:.045,pd:0},{faixa:2,max:36e4,aliq:.09,pd:8100},{faixa:3,max:72e4,aliq:.102,pd:12420},{faixa:4,max:18e5,aliq:.14,pd:39780},{faixa:5,max:36e5,aliq:.22,pd:183780},{faixa:6,max:48e5,aliq:.33,pd:828e3}]},p=t=>{const e=t?.value??t??"",r=String(e).replace(/[^\d.,-]/g,"").replace(/\./g,"").replace(",","."),o=parseFloat(r);return Number.isFinite(o)?o:0},_=t=>t>0&&Number.isFinite(t)?t:0,h=t=>{const e=String(t||"").toLowerCase().replace(/\s/g,"");return/(^|_)iii$|anexo_?iii|[^a-z]3[^a-z]?/.test(e)?"III":/(^|_)v$|anexo_?v|[^a-z]5[^a-z]?/.test(e)?"V":/(^|_)iv$|anexo_?iv|[^a-z]4[^a-z]?/.test(e)?"IV":""},v=(t,e)=>t==="simples_iv"||t==="presumido"||t==="real"||e==="IV"?.2:0,N=(t,e)=>{let r=0,o=0;for(const n of e){const a=Math.min(t,n.ceiling);if(a>o&&(r+=(a-o)*n.rate),o=n.ceiling,t<=n.ceiling)break}return r},L=(t,e,r,o)=>{if(t<=0)return 0;const n=Math.max(0,t-r*o),a=e.slice().reverse().find(s=>n>=s.min);return!a||a.rate===0?0:Math.max(0,n*a.rate-a.deduction)},i=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t||0),O=t=>new Intl.NumberFormat("pt-BR",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),d=t=>{const e=c.querySelector(`[name="${t}"]`);return e?e.value||"":(console.warn(`Field not found: ${t}`),"")},b=c.querySelector("[data-result-clt]"),q=c.querySelector("[data-result-pj]"),S=c.querySelector("[data-detail-clt]"),x=c.querySelector("[data-detail-pj]"),I=c.querySelector("[data-result-clt-pack]");if(!b||!q){console.error("Elementos de resultado não encontrados");return}const V=t=>{const e=t/12,o=t/12/3,n=t+e+o,a=N(n,u.inss),s=Math.max(0,n-a),l=L(s,u.irrf.tabela,u.irrf.dependente,0),f=n*y;return{liquido:Math.max(0,n-a-l),inss:a,irrf:l,fgtsMensal:f}},B=(t,e,r,o,n)=>{const a=_(t),s=_(r),l=_(o),f=h(e);if(!a||!s||!l||!f)return{liquido:0,das:0,inssProLabore:0,irpfProLabore:0,cpp:0,aliqEfet:0,anexoKey:f};const m=C[f];if(!m)return{liquido:0,das:0,inssProLabore:0,irpfProLabore:0,cpp:0,aliqEfet:0,anexoKey:f};const E=m.find(D=>s<=D.max)||m[m.length-1],T=s?Math.max(0,(s*E.aliq-E.pd)/s):0,g=a*T,J=u.inss.at(-1)?.ceiling??l,P=Math.min(l,J)*M,A=L(Math.max(0,l-P),u.irrf.tabela,u.irrf.dependente,0),F=l*v(n,f);return{liquido:Math.max(0,a-g-P-A-F),das:g,inssProLabore:P,irpfProLabore:A,cpp:F,aliqEfet:T,anexoKey:f}},z=t=>{if(!t){b.textContent="Informe o salário bruto.",S&&(S.textContent=""),I&&(I.textContent="");return}const{liquido:e,inss:r,irrf:o,fgtsMensal:n}=V(t);b.textContent=i(e),S&&(S.textContent=`INSS: ${i(r)} | IRRF: ${i(o)} | FGTS (depósito): ${i(n)}`),I&&(I.textContent=`No bolso: ${i(e)} | Pacote total: ${i(e+n)}`)},G=(t,e,r,o,n)=>{const a=B(t,e,r,o,n);if(!t||!e||!r){q.textContent="Informe faturamento, RBT12 e anexo.",x&&(x.textContent="");return}if(!a.anexoKey||!C[a.anexoKey]){q.textContent="Use Anexo III, IV ou V para cálculo.",x&&(x.textContent="");return}q.textContent=i(a.liquido),x&&(x.textContent=`DAS: ${i(a.das)} | INSS pró-labore: ${i(a.inssProLabore)} | IRPF pró-labore: ${i(a.irpfProLabore)} | CPP: ${i(a.cpp)} | Alíquota efetiva: ${O(a.aliqEfet)}`)},R=()=>{try{const t=p(d("salario")),e=p(d("faturamento")),r=d("anexo"),o=p(d("rbt12")),n=d("regime")||"simples_i_ii_iii_v",a=p(d("prolabore")),s=a>0?a:e*$;z(t),G(e,r,o,s,n)}catch(t){console.error("Erro no cálculo:",t)}};R(),c.addEventListener("input",R),c.addEventListener("change",R)}export{j as default,j as initCltPjCalculator};
